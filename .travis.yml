# 2013-11-13T16:39:56 by gatox .travis.yml Continuous Integration by Ninja-IDE
language: python

python:
  - 2.7
  - 3.3
    
virtualenv:
  system_site_packages: true  # allows install PyQt via apt-get and import it.
  
before_install: 
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start" 
  - sudo apt-get update -qq
  - sudo apt-get install -qq sloccount wget build-essential python3-dev python-dev 
  - sudo apt-get install -qq python-qt4 python-qt4-dev libqt4-dev python-sip-dev
  - sudo apt-get install -qq python3-pyqt4 python3-qt4-dev python3-sip-dev
  - pip install pep8 pip-tools coviolations_app coverage --use-mirrors --quiet
  - cd ../..
  - wget --quiet --output-document=sip.tar.gz http://downloads.sourceforge.net/project/pyqt/sip/sip-4.15.3/sip-4.15.3.tar.gz
  - tar -xf sip.tar.gz
  - cd sip-4.15.3
  - python -B configure.py
  - make
  - sudo make install
  - cd ninja-ide/ninja-ide
  - python -c 'import PyQt4, PyQt4.QtGui, PyQt4.QtCore'

install: true

before_script: rm --recursive --force --verbose *.pyc

script: ./run-tests ninja_tests

after_script: coverage report

after_success: covio

after_failure: covio

notifications:
  irc:
      channels: "irc.freenode.org#ninja-ide"
      template:
          - "%{repository}@%{branch}: %{message}(%{build_url})"
          - "Build: %{build_number}, SHA: %{commit}, Committer: %{author}, Diff: %{compare_url}"
      on_success: change
      on_failure: always
      use_notice: true  # false to disable
  email:
      recipients: dojo@ninja-ide.org
      template:
          - "%{repository}@%{branch}: %{message}(%{build_url})"
          - "Build: %{build_number}, SHA: %{commit}, Committer: %{author}, Diff: %{compare_url}"
      on_success: change
      on_failure: always

cache: apt
